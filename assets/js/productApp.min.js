Object.prototype._product_carousel=function(){let ele=this,isDownProduct=!1,startX,differ,toChange,eX,lastEX,currentX,__parent,maxScroll,smoothScrollTimeout,lastSmoothScroll,animeScroll,animeScrollTime=1e3,smoothScrollStrength=20,addClassTimeOut;function productMouseDown(e){animeScroll&&animeScroll.pause(),isDownProduct=!0,lastSmoothScroll=0,clearTimeout(addClassTimeOut),ele.classList.add("no"),currentX=parseInt(ele.style.marginLeft)||0,startX=e.x||e.touches[0].clientX,lastEX=startX}function productMouseUp(){if(isDownProduct)if(isDownProduct=!1,lastSmoothScroll){let ml,sum=parseInt(ele.style.marginLeft)+20*lastSmoothScroll;sum=sum<=0?sum:0,sum=sum>=-maxScroll?sum:-maxScroll,animeOverScroll(sum),addClassTimeOut=setTimeout(()=>{ele.classList.remove("no")},2e3/3)}else ele.classList.remove("no")}function productMouseMove(e){isDownProduct&&(eX=e.x||e.touches[0].clientX,differ=startX-eX,toChange=differ-currentX,toChange>=0&&toChange<=maxScroll?(ele.style.marginLeft=-toChange+"px",lastSmoothScroll=eX-lastEX,lastEX=eX,clearTimeout(smoothScrollTimeout),smoothScrollTimeout=setTimeout(()=>{lastSmoothScroll=0},10)):toChange<0?(currentX=differ,ele.style.marginLeft="0px"):maxScroll>0&&(currentX=differ-maxScroll,ele.style.marginLeft=-maxScroll+"px"))}function animeOverScroll(amount){animeScroll=anime({targets:ele,marginLeft:amount,easing:"easeOutCubic",duration:1e3})}ele.classList&&(__parent=ele.parentElement,maxScroll=ele.offsetWidth-__parent.offsetWidth,window.addEventListener("resize",()=>{maxScroll=ele.offsetWidth-__parent.offsetWidth}),ele.onmousedown=productMouseDown,window.addEventListener("mouseup",productMouseUp),window.addEventListener("mousemove",productMouseMove),ele.ontouchstart=productMouseDown,window.addEventListener("touchend",productMouseUp),window.addEventListener("touchmove",productMouseMove))};const modalController={modal:document.querySelector(".modal"),modal_overlay:document.querySelector(".modal .modal__overlay"),modal_content:document.querySelector(".modal .modal__inner"),body:document.body,icons:{Specialty:'<i class="icofont-coffee-alt"></i>',Coffee:'<i class="icofont-coffee-cup"></i>',"Blended Non-caffein":'<i class="icofont-beans"></i>',"Blended Beverage":'<i class="icofont-coffee-pot"></i>',Smoothie:'<i class="icofont-juice"></i>',Unknown:""},show:function(){this.body.classList.add("modal--active")},show_overlay:function(){this.body.classList.add("modal--active"),this.body.classList.add("modal--overlay")},hide:function(){this.body.classList.remove("modal--active"),this.body.classList.remove("modal--overlay")},reset:function(){this.modal_content.innerHTML=""},reset_hide:function(){this.hide(),this.reset()},show_product_menu:function(){let ele=document.createElement("div");ele.classList.add("modalFullMenu"),ele.innerHTML='<div class="modalFullMenu__header"><i class="icofont-restaurant-menu"></i><span> All items</span></div><ul class="modalFullMenu__categories"></ul><div class="modalFullMenu__close"><div class="modalFullMenu__close-mask"></div></div>',this.modal_content.appendChild(ele)},render_product_menu:function(){const menuContent=this.modal.querySelector(".modalFullMenu .modalFullMenu__categories");if(menuContent){menuContent.innerHTML="";let index=0,indexCate=0;for(let i of categories){let eleObj=categoryToHtml(i,this.icons[i]);menuContent.appendChild(eleObj.ele),index=indexCate++;for(let j of itemInCategory[i]){let productEle=productToHtml(j);eleObj.wrapper.appendChild(productEle)}product_carousel_handler(eleObj.wrapper)}animateProducts()}}},productController={app:document.querySelector(".app"),cover:document.querySelector(".app-cover__imgBox"),name:document.querySelector(".info__header-name"),cate:document.querySelector(".info__header-category"),des:document.querySelector(".info__body--des"),options:document.querySelector(".info__body--options"),priceBox:document.querySelector(".info__footer-price"),load:function(id){let objj=_product_items.find(r=>r.id==id);if(objj){let category=objj.category;category=browsingWithSubCategory&&objj.category_sub?`${category} - ${objj.category_sub}`:category,this.app.setAttribute("data-category",objj.category),this.app.setAttribute("data-category_sub",objj.category_sub||""),this.app.setAttribute("data-current_id",objj.id),this.cover.classList.remove("loaded");let imgBg=document.createElement("div");imgBg.classList.add("app-cover__imgBg"),this.cover.innerHTML="",this.cover.appendChild(imgBg);let fakeImg=new Image;fakeImg.onload=e=>{imgBg.style.backgroundImage=`url("${objj.png}")`,this.cover.classList.add("loaded")},fakeImg.src=objj.png,this.name.innerText=objj.name,this.cate.innerText=category,this.des.innerText=objj.des,this.options.innerHTML="",this.options.appendChild(optionToHtml(objj.typeText,objj.type,objj.currency,!0,objj.fixed)),objj.hasSweetness&&this.options.appendChild(optionToHtml(objj.sweetnessText,objj.sweetness,objj.currency,!0,objj.fixed)),objj.hasExtra&&this.options.appendChild(optionToHtml(objj.extraText,objj.extra,objj.currency,!1,objj.fixed)),this.priceBox.setAttribute("data-fixed",objj.fixed),this.priceBox.innerHTML=`Total cost:<span>${objj.currency} ${Math.min(...objj.type.map(r=>r.price))}</span>`,updateAvailableArrows()}}},animateMask={opening:!1,closing:!1,durationOpen:400,durationClose:300,delayForTransition:200,show:function(){this.opening=!0;const pcBtn=document.querySelector(".info__footer-menu"),pcBtnIcon=pcBtn.querySelector("i"),mask=document.querySelector(".info__footer-menuMASK"),maskIcon=mask.querySelector("i"),menu=document.querySelector(".modalFullMenu"),menuIcon=menu.querySelector("i");let bg=window.getComputedStyle(pcBtn).backgroundColor,color=window.getComputedStyle(pcBtnIcon).color,bound=pcBtn.getBoundingClientRect();mask.classList.add("active"),copyLocation(mask,pcBtn),mask.style.backgroundColor=bg,copyBorderRadius(mask,pcBtn),bound=pcBtnIcon.getBoundingClientRect(),copyLocation(maskIcon,pcBtnIcon),maskIcon.style.color=color,bg=window.getComputedStyle(menu).backgroundColor,bound=menu.getBoundingClientRect();let brs=getBorderRadius(menu);anime({targets:mask,top:bound.top,left:bound.left,width:bound.width,height:bound.height,backgroundColor:bg,borderTopLeftRadius:brs.tl,borderTopRightRadius:brs.tr,borderBottomLeftRadius:brs.bl,borderBottomRightRadius:brs.br,easing:"easeInOutQuad",duration:this.durationOpen}),bound=menuIcon.getBoundingClientRect(),color=window.getComputedStyle(menuIcon).color,anime({targets:maskIcon,top:bound.top,left:bound.left,width:bound.width,height:bound.height,color:color,easing:"easeInOutQuad",duration:this.durationOpen}),setTimeout(()=>{mask.style.opacity="1",mask.style.transition=`opacity ${this.delayForTransition}ms`,setTimeout(()=>{mask.style.opacity="0"},1),setTimeout(()=>{mask.style.transition=""},this.delayForTransition),setTimeout(()=>{mask.classList.remove("active"),this.opening=!1},this.delayForTransition+20)},this.durationOpen)},hide:function(){this.closing=!0;const pcBtn=document.querySelector(".info__footer-menu"),pcBtnIcon=pcBtn.querySelector("i"),mask=document.querySelector(".info__footer-menuMASK"),maskIcon=mask.querySelector("i"),menu=document.querySelector(".modalFullMenu"),menuIcon=menu.querySelector("i");let bg,color,bound;document.body.classList.remove("modal--overlay"),copyLocation(mask,menu),mask.style.opacity="0",mask.style.transition=`opacity ${this.delayForTransition}ms`,setTimeout(()=>{mask.style.opacity="1"},1),mask.classList.add("active"),setTimeout(()=>{mask.style.transition=""},this.delayForTransition),bg=window.getComputedStyle(pcBtn).backgroundColor,bound=pcBtn.getBoundingClientRect();let brs=getBorderRadius(pcBtn);setTimeout(()=>{menu.classList.remove("show"),anime({targets:mask,top:bound.top,left:bound.left,width:bound.width,height:bound.height,backgroundColor:bg,borderTopLeftRadius:brs.tl,borderTopRightRadius:brs.tr,borderBottomLeftRadius:brs.bl,borderBottomRightRadius:brs.br,easing:"easeInOutQuad",duration:this.durationClose}),bound=pcBtnIcon.getBoundingClientRect(),color=window.getComputedStyle(pcBtnIcon).color,anime({targets:maskIcon,top:bound.top,left:bound.left,width:bound.width,height:bound.height,color:color,easing:"easeInOutQuad",duration:this.durationClose})},this.delayForTransition),setTimeout(()=>{mask.classList.remove("active"),this.closing=!1},this.durationClose+this.delayForTransition+20)}};function separateItem(){let ttt={};for(let i of categories)ttt[i]=[];return _product_items.forEach(re=>{ttt[re.category].push(re)}),ttt}function getBound(ele){return ele.getBoundingClientRect()}function animateProduct(ele,_delay,dura){let tl;ele.style.opacity="0",ele.style.transition="0s",anime.timeline({targets:ele}).add({opacity:[0,1],scale:[.5,1],translateY:["100%",0],duration:dura,delay:_delay}),setTimeout(()=>{ele.removeAttribute("style")},dura+_delay+20)}function animateProducts(){let cate=document.querySelectorAll(".modalFullMenu__category"),index=0,indexCate=0;setTimeout(()=>{[...cate].forEach((r,i)=>{let products=cate[i].querySelectorAll(".menuCategory__item");index=indexCate++,[...products].forEach(rr=>{rr.offsetLeft<window.innerWidth&&animateProduct(rr,delayAnimationProductInMenu*index++,durationAnimationProductInMenu)})})},animateMask.durationOpen)}function copyLocation(ele1,ele2){const bound=ele2.getBoundingClientRect();ele1.style.top=bound.top+"px",ele1.style.left=bound.left+"px",ele1.style.width=bound.width+"px",ele1.style.height=bound.height+"px"}function copyBorderRadius(ele1,ele2){const _style=window.getComputedStyle(ele2);ele1.style.borderTopLeftRadius=_style.borderTopLeftRadius,ele1.style.borderTopRightRadius=_style.borderTopRightRadius,ele1.style.borderBottomLeftRadius=_style.borderBottomLeftRadius,ele1.style.borderBottomRightRadius=_style.borderBottomRightRadius}function getBorderRadius(ele2){const _style=window.getComputedStyle(ele2);return{tl:_style.borderTopLeftRadius,tr:_style.borderTopRightRadius,bl:_style.borderBottomLeftRadius,br:_style.borderBottomRightRadius}}function product_carousel_handler(wrapper){let width=0;for(let i of wrapper.children)width+=i.offsetWidth;wrapper.style.width=width+"px",wrapper._product_carousel()}function categoryToHtml(name,icon){let ele=document.createElement("li");ele.classList.add("modalFullMenu__category"),ele.innerHTML=`<div class="menuCategory__title">${icon} ${name}</div>`;let ul=document.createElement("ul");return ul.classList.add("menuCategory__items"),ele.appendChild(ul),{ele:ele,wrapper:ul}}function productToHtml(obj){let ob=obj,_price=Math.min(...ob.type.map(r=>r.price)),hasSub=ob.category_sub?" active":"",ele=document.createElement("li");ele.classList.add("menuCategory__item"),ele.innerHTML=`<div class="itemCard" data-id="${ob.id}"><div class="itemCard__header"><p class="itemCard__header_category${hasSub}">${ob.category_sub||ob.category}</p><p class="itemCard__header_name">${ob.name}</p></div><div class="itemCard__des">${ob.des_short}</div><div class="itemCard__price">${ob.currency} ${_price.toFixed(ob.fixed)}</div></div>`;let imgBox=document.createElement("div");imgBox.classList.add("itemCover");let imgBg=document.createElement("div");imgBg.classList.add("itemCoverBackground"),imgBox.appendChild(imgBg);let fakeImg=new Image;return fakeImg.onload=e=>{imgBg.style.backgroundImage=`url("${ob.png}")`,imgBox.classList.add("loaded")},fakeImg.src=ob.png,ele.appendChild(imgBox),ele}function autoSelectLowestFromUl(ul){let eles=ul.querySelectorAll(".info__option[data-price]"),lowest=parseFloat(eles[0].getAttribute("data-price")),lastAct=eles[0];lastAct.classList.add("active");for(let i of eles){let price;parseFloat(i.getAttribute("data-price"))<lowest&&(lastAct.classList.remove("active"),lastAct=i,lastAct.classList.add("active"),lowest=parseFloat(i.getAttribute("data-price")))}}function optionToHtml(title,options,currency,oneChoice,fixed){let ul=document.createElement("ul");ul.classList.add("info__options"),oneChoice&&ul.classList.add("info__options--oneChoice");let titleEle=document.createElement("li");titleEle.classList.add("info__option","info__option--title"),titleEle.innerText=title,ul.appendChild(titleEle);for(let i of options){let price=i.price?`${currency} ${i.price.toFixed(fixed)}`:"Free",li=document.createElement("li");li.classList.add("info__option"),li.setAttribute("data-price",i.price||"0"),li.setAttribute("data-cur",currency),li.innerHTML=`<p class="info__option-name">${i.name}</p><div class="info__option-price">${price}</div>`,ul.appendChild(li)}return oneChoice&&autoSelectLowestFromUl(ul),ul}function modalControls(){let product,isDown,btn,lastEx,lastEy;function productDown(e){if(!isDown){product=e.target.closest(".menuCategory__item");let isMouse=!e.button||0==e.button;product&&isMouse&&(isDown=!0,lastEx=e.x||e.touches[0].clientX,lastEy=e.y||e.touches[0].clientY)}}function productMove(e){if(isDown){let eX=e.x||e.touches[0].clientX,eY=e.y||e.touches[0].clientY;eX==lastEx&&eY==lastEy||(isDown=!1)}}function productUp(e){if(isDown){isDown=!1;let idEle=product.querySelector("*[data-id]");if(idEle){let id=parseInt(idEle.getAttribute("data-id")),subCategory=e.target.closest(".itemCard__header_category.active");browsingWithSubCategory=!!subCategory,animateMask.hide();let inter=setInterval(()=>{animateMask.closing||(clearInterval(inter),modalController.hide(),productController.load(id))},100)}}}modalController.modal_overlay.addEventListener("click",e=>{if(!animateMask.opening&&!animateMask.closing)if(modalController.modal_content.querySelector(".modalFullMenu")){animateMask.hide();let inter=setInterval(()=>{animateMask.closing||(clearInterval(inter),modalController.hide())},100)}else modalController.hide()}),modalController.modal_content.addEventListener("click",e=>{if(btn=e.target.closest(".modalFullMenu__close"),btn){animateMask.hide();let inter=setInterval(()=>{animateMask.closing||(clearInterval(inter),modalController.hide())},100)}}),modalController.modal_content.addEventListener("mousedown",productDown),modalController.modal_content.addEventListener("mousemove",productMove),modalController.modal_content.addEventListener("mouseup",productUp),modalController.modal_content.addEventListener("touchstart",productDown),modalController.modal_content.addEventListener("touchmove",productMove),modalController.modal_content.addEventListener("touchend",productUp)}function menuPopupControl(){const pcBtn=document.querySelector(".info__footer-menu"),pcBtnIcon=pcBtn.querySelector("i");let firstTime=!0;const mask=document.querySelector(".info__footer-menuMASK"),maskIcon=mask.querySelector("i"),animationDura=500;function clickFunc(){firstTime?(modalController.reset_hide(),modalController.show_overlay(),modalController.show_product_menu(),modalController.render_product_menu(),firstTime=!1):(modalController.show_overlay(),animateProducts());let menu=document.querySelector(".modalFullMenu");menu.classList.remove("show"),animateMask.show(),setTimeout(()=>{menu.classList.add("show")},animateMask.durationOpen)}pcBtn.onclick=clickFunc}function appControls(){function hasActive(ele){return ele&&ele.classList.contains("active")}function updatePrice(){let opts=options.querySelectorAll(".info__option.active"),price=0;for(let i of opts){let p;price+=parseFloat(i.getAttribute("data-price"))}productController.priceBox.innerHTML=`Total cost:<span>${opts[0].getAttribute("data-cur")} ${price.toFixed(parseInt(productController.priceBox.getAttribute("data-fixed"))||0)}</span>`}function clearAllActive(ele){let firstEle,currentEle=ele.parentElement.children[0];for(;currentEle;)currentEle.classList.remove("active"),currentEle.classList.remove("active--t"),currentEle.classList.remove("active--m"),currentEle.classList.remove("active--b"),currentEle=currentEle.nextElementSibling}function updateSelect(ele,oneChoice){let prev=ele.previousElementSibling,nex=ele.nextElementSibling;oneChoice&&clearAllActive(ele),ele.classList.contains("active")?(ele.classList.remove("active"),ele.classList.remove("active--t"),ele.classList.remove("active--m"),ele.classList.remove("active--b"),hasActive(prev)&&prev.classList.remove("active--t"),hasActive(nex)&&nex.classList.remove("active--b")):(ele.classList.add("active"),hasActive(prev)&&(ele.classList.add("active--b"),prev.classList.add("active--t")),hasActive(nex)&&(ele.classList.add("active--t"),nex.classList.add("active--b")))}function clickFunc(e){let target=e.target.closest(product);target&&(updateSelect(target,target.parentElement.classList.contains("info__options--oneChoice")),updatePrice())}const options=productController.app.querySelector(".info__body--options");let product=".info__option[data-price]";options.addEventListener("click",clickFunc)}function loadFirstProduct(){const params=new URLSearchParams(window.location.search);let id=params.get("id");id=id?parseInt(id):0;let cate=params.get("cate");cate&&(id=_product_items.find(r=>r.category==cate).id,(browsingWithSubCategory=params.get("cate_sub"))&&(id=_product_items.find(r=>r.category_sub==browsingWithSubCategory).id)),productController.load(id)}function updateAvailableArrows(){let arrowL=document.querySelector(".app-nav--left"),arrowR=document.querySelector(".app-nav--right"),category=productController.app.getAttribute("data-category"),filteredArray=itemInCategory[category];if(filteredArray.length>1)if(browsingWithSubCategory){let categorySub=productController.app.getAttribute("data-category_sub");filteredArray=filteredArray.filter(r=>r.category_sub==categorySub),filteredArray.length>1?(arrowL.style.filter="",arrowR.style.filter=""):(arrowL.style.filter="grayscale(1)",arrowR.style.filter="grayscale(1)")}else arrowL.style.filter="",arrowR.style.filter="";else arrowL.style.filter="grayscale(1)",arrowR.style.filter="grayscale(1)"}function arrowNavControl(){function arrow_animeFunc(ele){arrow_anime&&arrow_anime.pause(),arrow_anime=anime.timeline({targets:ele.querySelectorAll("path"),easing:"easeOutCubic",duration:200}),arrow_anime.add({translateX:"-30%",delay:anime.stagger(50)}).add({translateX:"0%",delay:anime.stagger(50)},200).add({targets:ele.querySelector("svg"),scale:.8,duration:300},0).add({targets:ele.querySelector("svg"),scale:1},300)}function switchProduct(mode){let category=productController.app.getAttribute("data-category"),id=productController.app.getAttribute("data-current_id"),filteredArray=itemInCategory[category];if(browsingWithSubCategory){let categorySub=productController.app.getAttribute("data-category_sub");filteredArray=filteredArray.filter(r=>r.category_sub==categorySub)}let pos,j=0;for(let i of filteredArray){if(i.id==id){pos=j;break}j++}if(filteredArray.length>1){if("next"==mode){let next=filteredArray[pos+1]?filteredArray[pos+1]:filteredArray[0];productController.load(next.id)}else{let prev=filteredArray[pos-1]?filteredArray[pos-1]:filteredArray[filteredArray.length-1];productController.load(prev.id)}return!0}return!1}let arrowL=document.querySelector(".app-nav--left"),arrowR=document.querySelector(".app-nav--right"),arrow_anime;arrowR.addEventListener("click",()=>{switchProduct("next")&&arrow_animeFunc(arrowR)}),arrowL.addEventListener("click",()=>{switchProduct("prev")&&arrow_animeFunc(arrowL)})}var browsingWithSubCategory=!1;const delayAnimationProductInMenu=50,durationAnimationProductInMenu=1200,categories=new Set(_product_items.map(r=>r.category)),itemInCategory=separateItem();modalControls(),appControls(),menuPopupControl(),arrowNavControl(),document.addEventListener("readystatechange",()=>{"complete"===document.readyState&&loadFirstProduct()});